---
import { FaBars, FaBowlingBall, FaBity, FaBorderAll } from "react-icons/fa6";
import Button from './Button.astro';
import { marked } from 'marked';
import { useTranslations } from "../../i18n/utils";
import { getStaticPathsLangs } from "../../libs/getStaticPaths";

// i18n
export const getStaticPaths = getStaticPathsLangs;
const { lang } = Astro.params as any;
const t = useTranslations(lang);

const buttonTrue = t('buttonTrue.text');
const buttonFalse = t('buttonFalse.text');

// Iconos
const icons = {
  tratamientosFaciales: FaBars,
  tratamientosCorporales: FaBowlingBall,
  masajesRelajantes: FaBity,
  EsteticaAvanzada: FaBorderAll,
};

interface Props {
  title: string;
  text: string;
  src: string;
  description: string;
  benefits?: string[];
  class?: string;
  iconName: string;
}

const {
  title,
  text,
  description,
  benefits = [],
  iconName,
  src,
  class: className = "",
} = Astro.props as Props;

const IconName = icons[iconName as keyof typeof icons] || FaBars;
const htmlDescription = marked.parse(description || "");
const htmlTitle = marked.parse(title || "");
const htmlBenefits = benefits.map((b) => marked.parseInline(b));
---

<article
  class:list={[
    "relative",
    "bg-white",
    "p-8",
    "rounded-3xl",
    "shadow-xl hover:shadow-2xl",
    "duration-500",
    "max-w-md",
    "mx-auto",
    "overflow-hidden",
    "group",
    className,
  ]}
>
  <!-- Círculo decorativo -->
  <div
    class:list={[
      "absolute",
      "-top-8",
      "-right-8",
      "w-32",
      "h-32",
      "bg-gradient-to-br",
      "from-pink",
      "to-pink-light",
      "rounded-full",
      "opacity-10 group-hover:opacity-20",
      "duration-500",
    ]}
  />

  <div class:list={["relative", "z-10"]}>
    <!-- Icono -->
    <div
      class:list={[
        "w-16",
        "h-16",
        "bg-gradient-to-br",
        "from-brown",
        "to-brown-light",
        "rounded-2xl",
        "flex",
        "items-center",
        "justify-center",
        "mb-6",
        "group-hover:scale-110",
        "duration-300",
      ]}
    >
      <span class:list={["text-white", "text-3xl"]}>
        <IconName />
      </span>
    </div>

    <!-- Título -->
    <h3
      class:list={[
        "font-title",
        "text-2xl",
        "text-brown group-hover:text-brown-light",
        "mb-4",
        "leading-tight",
        "duration-300",
      ]}
      set:html={htmlTitle}
    />

    <!-- Descripción -->
    <div
      class:list={["text-black", "text-sm", "leading-relaxed", "mb-6", "prose"]}
      set:html={htmlDescription}
    />

    <!-- Beneficios -->
    {
      htmlBenefits.length > 0 && (
        <div class:list={["mb-6"]}>
          <h4 class:list={["text-sm", "font-semibold", "text-brown", "mb-3"]}>
            Incluye:
          </h4>
          <div class:list={["space-y-2"]}>
            {htmlBenefits.map((htmlBenefit) => (
              <div
                class:list={[
                  "flex",
                  "items-start",
                  "text-xs",
                  "text-black",
                ]}
              >
                <div
                  class:list={[
                    "w-1.5",
                    "h-1.5",
                    "bg-pink",
                    "rounded-full",
                    "mt-1.5",
                    "mr-3",
                    "flex-shrink-0",
                  ]}
                />
                <span set:html={htmlBenefit} />
              </div>
            ))}
          </div>
        </div>
      )
    }

    <!-- Botones -->
    <div class:list={["flex", "gap-3"]}>
      <Button text={buttonTrue} href={src} isGhost />
      <Button text={buttonFalse} href={src} isGhost={false} />
    </div>
  </div>
</article>
